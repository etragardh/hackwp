# Exploit
## How to create an exploit

**Required methods**

These methods needs to be in every exploit script.
```
def get_vuln_data():
def is_vulnerable(target):
def get_methods():
def is_auth_required():
def get_author():
def get_thanks():
```

**Optional methods**
These are optional, however each exploit script needs to contain atleast one of these to work.
```
def rce(instruction, args):
def lfi(instruction, args):
def rfi(instruction, args):
def sqle(instruction, args):
def sqlr(instruction, args):
```

### get_vuln_data()
This needs to return an object that tells HackWP how to know if the target is vulnerable or not. This is a more `stealthy` check for vulnerable targets than using the more aggressive `is_vulnerable`.
**Sample definition**
```
def get_vuln_data():
    return {
        'core': False,
        'theme': {
            'slug':     'hello-elementor',
            'versions': {
                'from': '*',
                'to':   '1.9.6'
            }
        },
        'plugins': {
            {
                'slug':     'elementor-pro',
                'versions': {
                    'from': '1.2.1',
                    'to':   '1.2.3.1'
                }
            }
        },
        'custom': False
    }
```

### is_vulnerable(target)
This is an aggressive check if the target is vulnerable.<br />
ie if the vulnerability needs to be tested live before we know.

**Sample definition**
```
def is_vulnerable(target):
    # Try out RCE on target
    resp = rce('<?php echo "VULNERABLE"; ?>', {})
    # If the string "VULNERABLE" is present in the output
    # the target is vulnerable to RCE
    return re.search('VULNERABLE', resp)
```

### get_methods()
Get methods that this exploit can create / use

**Sample definition**
```
def get_methods():
    return ['RCE', 'SQLe', 'LFI', 'RFI']
```
If you have RCE, you should probably add lower impact as well to support as many payloads as possible.<br />

Every item returned here needs to be represented by a method.<br />
ie if you `return ['RCE']` you need to also `def rce(instructions, args):`

### is_auth_required()
Tell HackWP is this exploits needs authentication.<br />
ie HackWP can be used to both steal and use stolen cookies.<br />
If auth is required, HackWP will try to use stolen session cookies for all the request sent with this exploit.

**Sample definition**
```
def is_auth_required():
    return False
```
This means the exploit is unauthenticated.


## RCE (Remote Code Execution)





### RCE (Remote Code Execution)
Exploits that supports RCE needs to take php as input.
PHP input is the full php code with opening and closing tags as needed.

```
<?php echo "test"; ?>
<?php echo 'test'; ?>
```

Should both be accepted inputs.
The return should be the entire raw output.

### SQLe (SQL Execution)
Exploits that supports SQLe should take SQL syntax as input and output the results like this

STATUS: <bool>
AFFECTED ROWS: <int>
INSERT ID: <int>
ERROR: <string>
