#!/usr/bin/env python3
import requests, re
from packaging.version import Version

##
# Scan
# Perform a scan against the target to determine if it
# _might_ be vulnerable. ie checking versions, file paths, checksums.
# No actual exploit is done during scan, at least not persistant payloads
# False positives are accepted to a reasonable extent.

def scan(html, args):

    # Make a request to bricks styles to see the version
    r = requests.get(args.target + "/wp-content/themes/bricks/style.css")
    version = re.search("Version: (.*?)\n", r.text) 
    version = str(version[1])

    return Version(version) <= Version("1.9.6")
