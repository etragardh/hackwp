from helpers import *
import re, requests

##
# Module:       bricks
# Exploit:      1.9.6.1-rce
# Description:  Authenticated RCE against bricks version up to 1.9.6.1

# This exploit is not updated.
# Its just here for reference.

# The 1.9.6-rce is the one working with HackWP at the moment

def get_vuln_data():
    return {
        'core': False,
        'theme': {
            'slug':     'bricks',
            'versions': {
                'from': '*',
                'to':   '1.9.6.1'
            }
        },
        'plugins': False,
        'custom': False
    }

def is_vulnerable(target):
    return False

##
# Methods   (required)
def get_methods():
    return ['RCE'] 

def is_auth_required():
    return True

def rce(instruction, args):
    if args.verbose: pinfo("Execute PHP:", instruction)

    # Send file to bricks_auto_save
    # TODO: send the PHP

    # Return
    return "PHP is stored on the server, admin needs to preview the auto_save for it to detonate"

def get_author():
    return "@etragardh"

def get_thanks():
    return False
